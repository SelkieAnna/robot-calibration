function J = J_p(q, l, error, T_base, T_tool)
    %Ti = T_base * FK_irreducible(q, l, error);
    %Ti = inv(Ti(1:3,1:3));
    %Ti=[Ti,zeros(3,1);0 0 0 1];
    
    Htx = [0 0 0 1;
        0 0 0 0; 
        0 0 0 0;
        0 0 0 0];
    Hty = [0 0 0 0;
        0 0 0 1;
        0 0 0 0; 
        0 0 0 0];
    Htz = [0 0 0 0;
        0 0 0 0;
        0 0 0 1;
        0 0 0 0];
    Hrx = [0 0 0 0;
        0 0 -1 0;
        0 1 0 0;
        0 0 0 0];
    Hry = [0 0 1 0;
        0 0 0 0;
        -1 0 0 0;
        0 0 0 0];
    Hrz = [0 -1 0 0;
        1 0 0 0;
        0 0 0 0; 
        0 0 0 0];
    
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Htx*Ty(l(2)+error(2))*Ry(error(3))* ...
        Rx(q(2)+error(4))*Tz(l(3)+error(5))*Ry(error(6))*Rz(error(7))* ...
        Rx(q(3)+error(8))*Ty(l(5)+error(9))*Tz(l(4)+error(10))*Rz(error(11))* ...
        Ry(q(4)+error(12))*Tx(error(13))*Tz(error(14))*Rz(error(15))* ...
        Rx(q(5)+error(16))*Tz(error(17))*Rz(error(18))* ...
        Ry(q(6))*Rx(error(19))*Rz(error(20)) * ...
        T_tool;
    J2 = Td(1:3,4);
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Ty(l(2)+error(2))*Hty*Ry(error(3))* ...
        Rx(q(2)+error(4))*Tz(l(3)+error(5))*Ry(error(6))*Rz(error(7))* ...
        Rx(q(3)+error(8))*Ty(l(5)+error(9))*Tz(l(4)+error(10))*Rz(error(11))* ...
        Ry(q(4)+error(12))*Tx(error(13))*Tz(error(14))*Rz(error(15))* ...
        Rx(q(5)+error(16))*Tz(error(17))*Rz(error(18))* ...
        Ry(q(6))*Rx(error(19))*Rz(error(20)) * ...
        T_tool;
    J3 = Td(1:3,4);
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Ty(l(2)+error(2))*Ry(error(3))*Hry* ...
        Rx(q(2)+error(4))*Tz(l(3)+error(5))*Ry(error(6))*Rz(error(7))* ...
        Rx(q(3)+error(8))*Ty(l(5)+error(9))*Tz(l(4)+error(10))*Rz(error(11))* ...
        Ry(q(4)+error(12))*Tx(error(13))*Tz(error(14))*Rz(error(15))* ...
        Rx(q(5)+error(16))*Tz(error(17))*Rz(error(18))* ...
        Ry(q(6))*Rx(error(19))*Rz(error(20)) * ...
        T_tool;
    J4 = Td(1:3,4);
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Ty(l(2)+error(2))*Ry(error(3))* ...
        Rx(q(2)+error(4))*Hrx*Tz(l(3)+error(5))*Ry(error(6))*Rz(error(7))* ...
        Rx(q(3)+error(8))*Ty(l(5)+error(9))*Tz(l(4)+error(10))*Rz(error(11))* ...
        Ry(q(4)+error(12))*Tx(error(13))*Tz(error(14))*Rz(error(15))* ...
        Rx(q(5)+error(16))*Tz(error(17))*Rz(error(18))* ...
        Ry(q(6))*Rx(error(19))*Rz(error(20)) * ...
        T_tool;
    J5 = Td(1:3,4);
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Ty(l(2)+error(2))*Ry(error(3))* ...
        Rx(q(2)+error(4))*Tz(l(3)+error(5))*Htz*Ry(error(6))*Rz(error(7))* ...
        Rx(q(3)+error(8))*Ty(l(5)+error(9))*Tz(l(4)+error(10))*Rz(error(11))* ...
        Ry(q(4)+error(12))*Tx(error(13))*Tz(error(14))*Rz(error(15))* ...
        Rx(q(5)+error(16))*Tz(error(17))*Rz(error(18))* ...
        Ry(q(6))*Rx(error(19))*Rz(error(20)) * ...
        T_tool;
    J6 = Td(1:3,4);
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Ty(l(2)+error(2))*Ry(error(3))* ...
        Rx(q(2)+error(4))*Tz(l(3)+error(5))*Ry(error(6))*Hry*Rz(error(7))* ...
        Rx(q(3)+error(8))*Ty(l(5)+error(9))*Tz(l(4)+error(10))*Rz(error(11))* ...
        Ry(q(4)+error(12))*Tx(error(13))*Tz(error(14))*Rz(error(15))* ...
        Rx(q(5)+error(16))*Tz(error(17))*Rz(error(18))* ...
        Ry(q(6))*Rx(error(19))*Rz(error(20)) * ...
        T_tool;
    J7 = Td(1:3,4);
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Ty(l(2)+error(2))*Ry(error(3))* ...
        Rx(q(2)+error(4))*Tz(l(3)+error(5))*Ry(error(6))*Rz(error(7))*Hrz* ...
        Rx(q(3)+error(8))*Ty(l(5)+error(9))*Tz(l(4)+error(10))*Rz(error(11))* ...
        Ry(q(4)+error(12))*Tx(error(13))*Tz(error(14))*Rz(error(15))* ...
        Rx(q(5)+error(16))*Tz(error(17))*Rz(error(18))* ...
        Ry(q(6))*Rx(error(19))*Rz(error(20)) * ...
        T_tool;
    J8 = Td(1:3,4);
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Ty(l(2)+error(2))*Ry(error(3))* ...
        Rx(q(2)+error(4))*Tz(l(3)+error(5))*Ry(error(6))*Rz(error(7))* ...
        Rx(q(3)+error(8))*Hrx*Ty(l(5)+error(9))*Tz(l(4)+error(10))*Rz(error(11))* ...
        Ry(q(4)+error(12))*Tx(error(13))*Tz(error(14))*Rz(error(15))* ...
        Rx(q(5)+error(16))*Tz(error(17))*Rz(error(18))* ...
        Ry(q(6))*Rx(error(19))*Rz(error(20)) * ...
        T_tool;
    J9 = Td(1:3,4);
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Ty(l(2)+error(2))*Ry(error(3))* ...
        Rx(q(2)+error(4))*Tz(l(3)+error(5))*Ry(error(6))*Rz(error(7))* ...
        Rx(q(3)+error(8))*Ty(l(5)+error(9))*Hty*Tz(l(4)+error(10))*Rz(error(11))* ...
        Ry(q(4)+error(12))*Tx(error(13))*Tz(error(14))*Rz(error(15))* ...
        Rx(q(5)+error(16))*Tz(error(17))*Rz(error(18))* ...
        Ry(q(6))*Rx(error(19))*Rz(error(20)) * ...
        T_tool;
    J10 = Td(1:3,4);
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Ty(l(2)+error(2))*Ry(error(3))* ...
        Rx(q(2)+error(4))*Tz(l(3)+error(5))*Ry(error(6))*Rz(error(7))* ...
        Rx(q(3)+error(8))*Ty(l(5)+error(9))*Tz(l(4)+error(10))*Htz*Rz(error(11))* ...
        Ry(q(4)+error(12))*Tx(error(13))*Tz(error(14))*Rz(error(15))* ...
        Rx(q(5)+error(16))*Tz(error(17))*Rz(error(18))* ...
        Ry(q(6))*Rx(error(19))*Rz(error(20)) * ...
        T_tool;
    J11 = Td(1:3,4);
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Ty(l(2)+error(2))*Ry(error(3))* ...
        Rx(q(2)+error(4))*Tz(l(3)+error(5))*Ry(error(6))*Rz(error(7))* ...
        Rx(q(3)+error(8))*Ty(l(5)+error(9))*Tz(l(4)+error(10))*Rz(error(11))*Hrz* ...
        Ry(q(4)+error(12))*Tx(error(13))*Tz(error(14))*Rz(error(15))* ...
        Rx(q(5)+error(16))*Tz(error(17))*Rz(error(18))* ...
        Ry(q(6))*Rx(error(19))*Rz(error(20)) * ...
        T_tool;
    J12 = Td(1:3,4);
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Ty(l(2)+error(2))*Ry(error(3))* ...
        Rx(q(2)+error(4))*Tz(l(3)+error(5))*Ry(error(6))*Rz(error(7))* ...
        Rx(q(3)+error(8))*Ty(l(5)+error(9))*Tz(l(4)+error(10))*Rz(error(11))* ...
        Ry(q(4)+error(12))*Hry*Tx(error(13))*Tz(error(14))*Rz(error(15))* ...
        Rx(q(5)+error(16))*Tz(error(17))*Rz(error(18))* ...
        Ry(q(6))*Rx(error(19))*Rz(error(20)) * ...
        T_tool;
    J13 = Td(1:3,4);
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Ty(l(2)+error(2))*Ry(error(3))* ...
        Rx(q(2)+error(4))*Tz(l(3)+error(5))*Ry(error(6))*Rz(error(7))* ...
        Rx(q(3)+error(8))*Ty(l(5)+error(9))*Tz(l(4)+error(10))*Rz(error(11))* ...
        Ry(q(4)+error(12))*Tx(error(13))*Htx*Tz(error(14))*Rz(error(15))* ...
        Rx(q(5)+error(16))*Tz(error(17))*Rz(error(18))* ...
        Ry(q(6))*Rx(error(19))*Rz(error(20)) * ...
        T_tool;
    J14 = Td(1:3,4);
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Ty(l(2)+error(2))*Ry(error(3))* ...
        Rx(q(2)+error(4))*Tz(l(3)+error(5))*Ry(error(6))*Rz(error(7))* ...
        Rx(q(3)+error(8))*Ty(l(5)+error(9))*Tz(l(4)+error(10))*Rz(error(11))* ...
        Ry(q(4)+error(12))*Tx(error(13))*Tz(error(14))*Htz*Rz(error(15))* ...
        Rx(q(5)+error(16))*Tz(error(17))*Rz(error(18))* ...
        Ry(q(6))*Rx(error(19))*Rz(error(20)) * ...
        T_tool;
    J15 = Td(1:3,4);
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Ty(l(2)+error(2))*Ry(error(3))* ...
        Rx(q(2)+error(4))*Tz(l(3)+error(5))*Ry(error(6))*Rz(error(7))* ...
        Rx(q(3)+error(8))*Ty(l(5)+error(9))*Tz(l(4)+error(10))*Rz(error(11))* ...
        Ry(q(4)+error(12))*Tx(error(13))*Tz(error(14))*Rz(error(15))*Hrz* ...
        Rx(q(5)+error(16))*Tz(error(17))*Rz(error(18))* ...
        Ry(q(6))*Rx(error(19))*Rz(error(20)) * ...
        T_tool;
    J16 = Td(1:3,4);
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Ty(l(2)+error(2))*Ry(error(3))* ...
        Rx(q(2)+error(4))*Tz(l(3)+error(5))*Ry(error(6))*Rz(error(7))* ...
        Rx(q(3)+error(8))*Ty(l(5)+error(9))*Tz(l(4)+error(10))*Rz(error(11))* ...
        Ry(q(4)+error(12))*Tx(error(13))*Tz(error(14))*Rz(error(15))* ...
        Rx(q(5)+error(16))*Hrx*Tz(error(17))*Rz(error(18))* ...
        Ry(q(6))*Rx(error(19))*Rz(error(20)) * ...
        T_tool;
    J17 = Td(1:3,4);
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Ty(l(2)+error(2))*Ry(error(3))* ...
        Rx(q(2)+error(4))*Tz(l(3)+error(5))*Ry(error(6))*Rz(error(7))* ...
        Rx(q(3)+error(8))*Ty(l(5)+error(9))*Tz(l(4)+error(10))*Rz(error(11))* ...
        Ry(q(4)+error(12))*Tx(error(13))*Tz(error(14))*Rz(error(15))* ...
        Rx(q(5)+error(16))*Tz(error(17))*Htz*Rz(error(18))* ...
        Ry(q(6))*Rx(error(19))*Rz(error(20)) * ...
        T_tool;
    J18 = Td(1:3,4);
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Ty(l(2)+error(2))*Ry(error(3))* ...
        Rx(q(2)+error(4))*Tz(l(3)+error(5))*Ry(error(6))*Rz(error(7))* ...
        Rx(q(3)+error(8))*Ty(l(5)+error(9))*Tz(l(4)+error(10))*Rz(error(11))* ...
        Ry(q(4)+error(12))*Tx(error(13))*Tz(error(14))*Rz(error(15))* ...
        Rx(q(5)+error(16))*Tz(error(17))*Rz(error(18))*Hrz* ...
        Ry(q(6))*Rx(error(19))*Rz(error(20)) * ...
        T_tool;
    J19 = Td(1:3,4);
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Ty(l(2)+error(2))*Ry(error(3))* ...
        Rx(q(2)+error(4))*Tz(l(3)+error(5))*Ry(error(6))*Rz(error(7))* ...
        Rx(q(3)+error(8))*Ty(l(5)+error(9))*Tz(l(4)+error(10))*Rz(error(11))* ...
        Ry(q(4)+error(12))*Tx(error(13))*Tz(error(14))*Rz(error(15))* ...
        Rx(q(5)+error(16))*Tz(error(17))*Rz(error(18))* ...
        Ry(q(6))*Rx(error(19))*Hrx*Rz(error(20)) * ...
        T_tool;
    J21 = Td(1:3,4);
    Td = T_base * ...
        Rz(q(1))*Tx(error(1))*Ty(l(2)+error(2))*Ry(error(3))* ...
        Rx(q(2)+error(4))*Tz(l(3)+error(5))*Ry(error(6))*Rz(error(7))* ...
        Rx(q(3)+error(8))*Ty(l(5)+error(9))*Tz(l(4)+error(10))*Rz(error(11))* ...
        Ry(q(4)+error(12))*Tx(error(13))*Tz(error(14))*Rz(error(15))* ...
        Rx(q(5)+error(16))*Tz(error(17))*Rz(error(18))* ...
        Ry(q(6))*Rx(error(19))*Rz(error(20))*Hrz* ...
        T_tool;
    J22 = Td(1:3,4);
    
    J = [J2, J3, J4, J5, J6, J7, J8, J9, J10, J11, ...
         J12, J13, J14, J15, J16, J17, J18, J19, J21, J22];
end

